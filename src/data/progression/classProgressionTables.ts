import type { LevelProgression } from '../../types/levelProgression';

// Fighter: High BAB, good Fort save
export const fighterProgression: Record<number, LevelProgression> = {
  1: {
    level: 1,
    baseAttackBonus: 1,
    fortitudeSave: 2,
    reflexSave: 0,
    willSave: 0,
    classFeatures: ['fighter-bonus-feat'],
    featGained: true,  // Bonus feat at level 1
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  2: {
    level: 2,
    baseAttackBonus: 2,
    fortitudeSave: 3,
    reflexSave: 0,
    willSave: 0,
    classFeatures: ['fighter-bonus-feat-2'],
    featGained: true,  // Fighter gets bonus feats
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  3: {
    level: 3,
    baseAttackBonus: 3,
    fortitudeSave: 3,
    reflexSave: 1,
    willSave: 1,
    classFeatures: ['weapon-specialization'],
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  4: {
    level: 4,
    baseAttackBonus: 4,
    fortitudeSave: 4,
    reflexSave: 1,
    willSave: 1,
    classFeatures: ['fighter-bonus-feat-4'],
    featGained: true,
    skillPoints: 2,
    abilityScoreIncrease: true,  // +1 ability at level 4
  },
  5: {
    level: 5,
    baseAttackBonus: 5,
    fortitudeSave: 4,
    reflexSave: 1,
    willSave: 1,
    classFeatures: ['improved-critical'],
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
};

// Rogue: Medium BAB, good Reflex save
export const rogueProgression: Record<number, LevelProgression> = {
  1: {
    level: 1,
    baseAttackBonus: 0,
    fortitudeSave: 0,
    reflexSave: 2,
    willSave: 0,
    classFeatures: ['sneak-attack-1d6', 'trapfinding'],
    featGained: false,
    skillPoints: 8,  // Rogues get more skill points
    abilityScoreIncrease: false,
  },
  2: {
    level: 2,
    baseAttackBonus: 1,
    fortitudeSave: 0,
    reflexSave: 3,
    willSave: 0,
    classFeatures: ['evasion'],
    featGained: false,
    skillPoints: 8,
    abilityScoreIncrease: false,
  },
  3: {
    level: 3,
    baseAttackBonus: 2,
    fortitudeSave: 1,
    reflexSave: 3,
    willSave: 1,
    classFeatures: ['sneak-attack-2d6', 'uncanny-dodge'],
    featGained: true,  // Standard feat at level 3
    skillPoints: 8,
    abilityScoreIncrease: false,
  },
  4: {
    level: 4,
    baseAttackBonus: 3,
    fortitudeSave: 1,
    reflexSave: 4,
    willSave: 1,
    classFeatures: [],
    featGained: false,
    skillPoints: 8,
    abilityScoreIncrease: true,
  },
  5: {
    level: 5,
    baseAttackBonus: 3,
    fortitudeSave: 1,
    reflexSave: 4,
    willSave: 1,
    classFeatures: ['sneak-attack-3d6'],
    featGained: false,
    skillPoints: 8,
    abilityScoreIncrease: false,
  },
};

// Wizard: Low BAB, good Will save, spell progression
export const wizardProgression: Record<number, LevelProgression> = {
  1: {
    level: 1,
    baseAttackBonus: 0,
    fortitudeSave: 0,
    reflexSave: 0,
    willSave: 2,
    classFeatures: ['scribe-scroll', 'arcane-spellcasting'],
    spellsPerDay: { level0: 3, level1: 1, level2: 0, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  2: {
    level: 2,
    baseAttackBonus: 1,
    fortitudeSave: 0,
    reflexSave: 0,
    willSave: 3,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 2, level2: 0, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  3: {
    level: 3,
    baseAttackBonus: 1,
    fortitudeSave: 1,
    reflexSave: 1,
    willSave: 3,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 2, level2: 1, level3: 0 },
    featGained: true,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  4: {
    level: 4,
    baseAttackBonus: 2,
    fortitudeSave: 1,
    reflexSave: 1,
    willSave: 4,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 3, level2: 2, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: true,
  },
  5: {
    level: 5,
    baseAttackBonus: 2,
    fortitudeSave: 1,
    reflexSave: 1,
    willSave: 4,
    classFeatures: ['bonus-feat-wizard'],
    spellsPerDay: { level0: 4, level1: 3, level2: 2, level3: 1 },
    featGained: true,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
};

// Cleric: Medium BAB, good Fort/Will saves, spell progression
export const clericProgression: Record<number, LevelProgression> = {
  1: {
    level: 1,
    baseAttackBonus: 0,
    fortitudeSave: 2,
    reflexSave: 0,
    willSave: 2,
    classFeatures: ['turn-undead', 'divine-spellcasting'],
    spellsPerDay: { level0: 3, level1: 1, level2: 0, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  2: {
    level: 2,
    baseAttackBonus: 1,
    fortitudeSave: 3,
    reflexSave: 0,
    willSave: 3,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 2, level2: 0, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  3: {
    level: 3,
    baseAttackBonus: 2,
    fortitudeSave: 3,
    reflexSave: 1,
    willSave: 3,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 2, level2: 1, level3: 0 },
    featGained: true,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
  4: {
    level: 4,
    baseAttackBonus: 3,
    fortitudeSave: 4,
    reflexSave: 1,
    willSave: 4,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 3, level2: 2, level3: 0 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: true,
  },
  5: {
    level: 5,
    baseAttackBonus: 3,
    fortitudeSave: 4,
    reflexSave: 1,
    willSave: 4,
    classFeatures: [],
    spellsPerDay: { level0: 4, level1: 3, level2: 2, level3: 1 },
    featGained: false,
    skillPoints: 2,
    abilityScoreIncrease: false,
  },
};

export function getClassProgression(className: string, level: number): LevelProgression | null {
  const progressionTable = {
    Fighter: fighterProgression,
    Rogue: rogueProgression,
    Wizard: wizardProgression,
    Cleric: clericProgression,
  }[className as 'Fighter' | 'Rogue' | 'Wizard' | 'Cleric'];

  return progressionTable?.[level] || null;
}
